<CourseFloatingBanner chapter={2}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/agents-course/blob/main/notebooks/unit2/smolagents/multiagent_notebook.ipynb"},
]} />

# å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ

å¤šæ™ºèƒ½ä½“ç³»ç»Ÿä½¿**ä¸“ä¸šæ™ºèƒ½ä½“èƒ½å¤Ÿåœ¨å¤æ‚ä»»åŠ¡ä¸Šè¿›è¡Œåä½œ**ï¼Œæé«˜æ¨¡å—åŒ–ã€å¯æ‰©å±•æ€§å’Œç¨³å¥æ€§ã€‚ä¸ä¾èµ–å•ä¸€æ™ºèƒ½ä½“ï¼Œä»»åŠ¡åˆ†é…ç»™å…·æœ‰ä¸åŒèƒ½åŠ›çš„æ™ºèƒ½ä½“ã€‚  

åœ¨ **smolagents** ä¸­ï¼Œä¸åŒçš„æ™ºèƒ½ä½“å¯ä»¥ç»„åˆèµ·æ¥ç”Ÿæˆ Python ä»£ç ã€è°ƒç”¨å¤–éƒ¨å·¥å…·ã€æ‰§è¡Œç½‘ç»œæœç´¢ç­‰ã€‚é€šè¿‡ç¼–æ’è¿™äº›æ™ºèƒ½ä½“ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¼ºå¤§çš„å·¥ä½œæµã€‚

ä¸€ä¸ªå…¸å‹çš„è®¾ç½®å¯èƒ½åŒ…æ‹¬ï¼š
- **ç®¡ç†æ™ºèƒ½ä½“ï¼ˆManager Agentï¼‰** ç”¨äºä»»åŠ¡å§”æ´¾  
- **ä»£ç è§£é‡Šå™¨æ™ºèƒ½ä½“ï¼ˆCode Interpreter Agentï¼‰** ç”¨äºä»£ç æ‰§è¡Œ  
- **ç½‘ç»œæœç´¢æ™ºèƒ½ä½“ï¼ˆWeb Search Agentï¼‰** ç”¨äºä¿¡æ¯æ£€ç´¢  

ä¸‹å›¾è¯´æ˜äº†ä¸€ä¸ªç®€å•çš„å¤šæ™ºèƒ½ä½“æ¶æ„ï¼Œå…¶ä¸­**ç®¡ç†æ™ºèƒ½ä½“**åè°ƒ**ä»£ç è§£é‡Šå™¨å·¥å…·**å’Œ**ç½‘ç»œæœç´¢æ™ºèƒ½ä½“**ï¼Œåè€…åˆ©ç”¨åƒ `DuckDuckGoSearchTool` å’Œ `VisitWebpageTool` è¿™æ ·çš„å·¥å…·æ¥æ”¶é›†ç›¸å…³ä¿¡æ¯ã€‚

<img src="https://mermaid.ink/img/pako:eNp1kc1qhTAQRl9FUiQb8wIpdNO76eKubrmFks1oRg3VSYgjpYjv3lFL_2hnMWQOJwn5sqgmelRWleUSKLAtFs09jqhtoWuYUFfFAa6QA9QDTnpzamheuhxn8pt40-6l13UtS0ddhtQXj6dbR4XUGQg6zEYasTF393KjeSDGnDJKNxzj8I_7hLW5IOSmP9CH9hv_NL-d94d4DVNg84p1EnK4qlIj5hGClySWbadT-6OdsrL02MI8sFOOVkciw8zx8kaNspxnrJQE0fXKtjBMMs3JA-MpgOQwftIE9Bzj14w-cMznI_39E9Z3p0uFoA?type=png" style='background: white;'>

## å¤šæ™ºèƒ½ä½“ç³»ç»Ÿå®æˆ˜  

å¤šæ™ºèƒ½ä½“ç³»ç»Ÿç”±å¤šä¸ªä¸“ä¸šæ™ºèƒ½ä½“åœ¨ **ç¼–æ’æ™ºèƒ½ä½“ï¼ˆOrchestrator Agentï¼‰** çš„åè°ƒä¸‹å…±åŒå·¥ä½œç»„æˆã€‚è¿™ç§æ–¹æ³•é€šè¿‡åœ¨å…·æœ‰ä¸åŒè§’è‰²çš„æ™ºèƒ½ä½“ä¹‹é—´åˆ†é…ä»»åŠ¡æ¥å®ç°å¤æ‚çš„å·¥ä½œæµã€‚  

ä¾‹å¦‚ï¼Œ**å¤šæ™ºèƒ½ä½“ RAG ç³»ç»Ÿ**å¯ä»¥æ•´åˆï¼š  
- **ç½‘ç»œæ™ºèƒ½ä½“ï¼ˆWeb Agentï¼‰** ç”¨äºæµè§ˆäº’è”ç½‘ã€‚  
- **æ£€ç´¢æ™ºèƒ½ä½“ï¼ˆRetriever Agentï¼‰** ç”¨äºä»çŸ¥è¯†åº“è·å–ä¿¡æ¯ã€‚  
- **å›¾åƒç”Ÿæˆæ™ºèƒ½ä½“ï¼ˆImage Generation Agentï¼‰** ç”¨äºç”Ÿæˆè§†è§‰å†…å®¹ã€‚  

æ‰€æœ‰è¿™äº›æ™ºèƒ½ä½“åœ¨ç®¡ç†ä»»åŠ¡å§”æ´¾å’Œäº¤äº’çš„ç¼–æ’è€…ä¸‹è¿è¡Œã€‚  

## ç”¨å¤šæ™ºèƒ½ä½“å±‚æ¬¡ç»“æ„è§£å†³å¤æ‚ä»»åŠ¡

<Tip>
ä½ å¯ä»¥åœ¨ <a href="https://huggingface.co/agents-course/notebooks/blob/main/unit2/smolagents/multiagent_notebook.ipynb" target="_blank">è¿™ä¸ªç¬”è®°æœ¬</a> ä¸­è·Ÿéšä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ Google Colab è¿è¡Œã€‚
</Tip>

æ¥å¾…ä¼šå³å°†åˆ°æ¥ï¼åœ¨ä½ çš„å¸®åŠ©ä¸‹ï¼Œé˜¿å°”å¼—é›·å¾·ç°åœ¨å‡ ä¹å®Œæˆäº†å‡†å¤‡å·¥ä½œã€‚

ä½†ç°åœ¨æœ‰ä¸ªé—®é¢˜ï¼šè™è è½¦ä¸è§äº†ã€‚é˜¿å°”å¼—é›·å¾·éœ€è¦æ‰¾åˆ°æ›¿ä»£å“ï¼Œè€Œä¸”è¦å¿«ã€‚

å¹¸è¿çš„æ˜¯ï¼Œå·²ç»æœ‰ä¸€äº›å…³äºå¸ƒé²æ–¯Â·éŸ¦æ©ç”Ÿæ´»çš„ä¼ è®°ç”µå½±ï¼Œæ‰€ä»¥ä¹Ÿè®¸é˜¿å°”å¼—é›·å¾·å¯ä»¥ä»æŸä¸ªç”µå½±æ‹æ‘„ç°åœºç•™ä¸‹çš„æ±½è½¦ä¸­è·å–ä¸€è¾†ï¼Œå¹¶å°†å…¶é‡æ–°æ”¹é€ åˆ°ç°ä»£æ ‡å‡†ï¼Œè¿™å½“ç„¶ä¼šåŒ…æ‹¬å®Œå…¨è‡ªåŠ¨é©¾é©¶é€‰é¡¹ã€‚

ä½†è¿™å¯èƒ½åœ¨ä¸–ç•Œå„åœ°çš„ä»»ä½•æ‹æ‘„åœ°ç‚¹â€”â€”å¯èƒ½æ•°é‡ä¼—å¤šã€‚

æ‰€ä»¥é˜¿å°”å¼—é›·å¾·éœ€è¦ä½ çš„å¸®åŠ©ã€‚ä½ èƒ½æ„å»ºä¸€ä¸ªèƒ½å¤Ÿè§£å†³è¿™ä¸ªä»»åŠ¡çš„æ™ºèƒ½ä½“å—ï¼Ÿ

> ğŸ‘‰ Find all Batman filming locations in the world, calculate the time to transfer via boat to there, and represent them on a map, with a color varying by boat transfer time. Also represent some supercar factories with the same boat transfer time.

è®©æˆ‘ä»¬æ¥æ„å»ºè¿™ä¸ªï¼

è¿™ä¸ªä¾‹å­éœ€è¦ä¸€äº›é¢å¤–çš„åŒ…ï¼Œæ‰€ä»¥é¦–å…ˆå®‰è£…å®ƒä»¬ï¼š

```bash
pip install 'smolagents[litellm]' matplotlib geopandas shapely kaleido -q
```

### æˆ‘ä»¬é¦–å…ˆåˆ¶ä½œä¸€ä¸ªå·¥å…·æ¥è·å–è´§è¿é£æœºè½¬è¿æ—¶é—´ã€‚

```python
import math
from typing import Optional, Tuple

from smolagents import tool


@tool
def calculate_cargo_travel_time(
    origin_coords: Tuple[float, float],
    destination_coords: Tuple[float, float],
    cruising_speed_kmh: Optional[float] = 750.0,  # è´§è¿é£æœºçš„å¹³å‡é€Ÿåº¦
) -> float:
    """
    Calculate the travel time for a cargo plane between two points on Earth using great-circle distance.

    Args:
        origin_coords: Tuple of (latitude, longitude) for the starting point
        destination_coords: Tuple of (latitude, longitude) for the destination
        cruising_speed_kmh: Optional cruising speed in km/h (defaults to 750 km/h for typical cargo planes)

    Returns:
        float: The estimated travel time in hours

    Example:
        >>> # Chicago (41.8781Â° N, 87.6298Â° W) to Sydney (33.8688Â° S, 151.2093Â° E)
        >>> result = calculate_cargo_travel_time((41.8781, -87.6298), (-33.8688, 151.2093))
    """

    def to_radians(degrees: float) -> float:
        return degrees * (math.pi / 180)

    # æå–åæ ‡
    lat1, lon1 = map(to_radians, origin_coords)
    lat2, lon2 = map(to_radians, destination_coords)

    # åœ°çƒåŠå¾„ï¼ˆå…¬é‡Œï¼‰
    EARTH_RADIUS_KM = 6371.0

    # ä½¿ç”¨åŠæ­£çŸ¢å…¬å¼è®¡ç®—å¤§åœ†è·ç¦»
    dlon = lon2 - lon1
    dlat = lat2 - lat1

    a = (
        math.sin(dlat / 2) ** 2
        + math.cos(lat1) * math.cos(lat2) * math.sin(dlon / 2) ** 2
    )
    c = 2 * math.asin(math.sqrt(a))
    distance = EARTH_RADIUS_KM * c

    # å¢åŠ 10%ä»¥è€ƒè™‘éç›´æ¥è·¯çº¿å’Œç©ºä¸­äº¤é€šç®¡åˆ¶
    actual_distance = distance * 1.1

    # è®¡ç®—é£è¡Œæ—¶é—´
    # ä¸ºèµ·é£å’Œç€é™†ç¨‹åºå¢åŠ 1å°æ—¶
    flight_time = (actual_distance / cruising_speed_kmh) + 1.0

    # æ ¼å¼åŒ–ç»“æœ
    return round(flight_time, 2)


print(calculate_cargo_travel_time((41.8781, -87.6298), (-33.8688, 151.2093)))
```

### è®¾ç½®æ™ºèƒ½ä½“

å¯¹äºæ¨¡å‹æä¾›å•†ï¼Œæˆ‘ä»¬ä½¿ç”¨ Together AIï¼Œè¿™æ˜¯ [Hub ä¸Šçš„æ–°æ¨ç†æä¾›å•†](https://huggingface.co/blog/inference-providers)ä¹‹ä¸€ï¼

GoogleSearchTool ä½¿ç”¨ [Serper API](https://serper.dev) æœç´¢ç½‘ç»œï¼Œå› æ­¤è¿™éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ `SERPAPI_API_KEY` å¹¶ä¼ é€’ `provider="serpapi"` æˆ–è€…æ‹¥æœ‰ `SERPER_API_KEY` å¹¶ä¼ é€’ `provider=serper`ã€‚

å¦‚æœä½ æ²¡æœ‰è®¾ç½®ä»»ä½• Serp API æä¾›å•†ï¼Œä½ å¯ä»¥ä½¿ç”¨ `DuckDuckGoSearchTool`ï¼Œä½†è¯·æ³¨æ„å®ƒæœ‰é€Ÿç‡é™åˆ¶ã€‚

```python
import os
from PIL import Image
from smolagents import CodeAgent, GoogleSearchTool, HfApiModel, VisitWebpageTool

model = HfApiModel(model_id="Qwen/Qwen2.5-Coder-32B-Instruct", provider="together")
```

æˆ‘ä»¬å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„æ™ºèƒ½ä½“ä½œä¸ºåŸºçº¿ï¼Œä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªç®€å•çš„æŠ¥å‘Šã€‚

```python
task = """Find all Batman filming locations in the world, calculate the time to transfer via cargo plane to here (we're in Gotham, 40.7128Â° N, 74.0060Â° W), and return them to me as a pandas dataframe.
Also give me some supercar factories with the same cargo plane transfer time."""
```

```python
agent = CodeAgent(
    model=model,
    tools=[GoogleSearchTool("serper"), VisitWebpageTool(), calculate_cargo_travel_time],
    additional_authorized_imports=["pandas"],
    max_steps=20,
)
```

```python
result = agent.run(task)
```

```python
result
```

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒç”Ÿæˆäº†è¿™ä¸ªè¾“å‡ºï¼š

```python
|  | Location                                             | Travel Time to Gotham (hours) |
|--|------------------------------------------------------|------------------------------|
| 0  | Necropolis Cemetery, Glasgow, Scotland, UK         | 8.60                         |
| 1  | St. George's Hall, Liverpool, England, UK         | 8.81                         |
| 2  | Two Temple Place, London, England, UK             | 9.17                         |
| 3  | Wollaton Hall, Nottingham, England, UK           | 9.00                         |
| 4  | Knebworth House, Knebworth, Hertfordshire, UK    | 9.15                         |
| 5  | Acton Lane Power Station, Acton Lane, Acton, UK  | 9.16                         |
| 6  | Queensboro Bridge, New York City, USA            | 1.01                         |
| 7  | Wall Street, New York City, USA                  | 1.00                         |
| 8  | Mehrangarh Fort, Jodhpur, Rajasthan, India       | 18.34                        |
| 9  | Turda Gorge, Turda, Romania                      | 11.89                        |
| 10 | Chicago, USA                                     | 2.68                         |
| 11 | Hong Kong, China                                 | 19.99                        |
| 12 | Cardington Studios, Northamptonshire, UK        | 9.10                         |
| 13 | Warner Bros. Leavesden Studios, Hertfordshire, UK | 9.13                         |
| 14 | Westwood, Los Angeles, CA, USA                  | 6.79                         |
| 15 | Woking, UK (McLaren)                             | 9.13                         |
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ ä¸€äº›ä¸“é—¨çš„è§„åˆ’æ­¥éª¤å’Œæ›´å¤šçš„æç¤ºæ¥è¿›ä¸€æ­¥æ”¹è¿›è¿™ä¸€ç‚¹ã€‚

è§„åˆ’æ­¥éª¤å…è®¸æ™ºèƒ½ä½“æå‰æ€è€ƒå¹¶è§„åˆ’å…¶ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼Œè¿™å¯¹äºæ›´å¤æ‚çš„ä»»åŠ¡éå¸¸æœ‰ç”¨ã€‚

```python
agent.planning_interval = 4

detailed_report = agent.run(f"""
You're an expert analyst. You make comprehensive reports after visiting many websites.
Don't hesitate to search for many queries at once in a for loop.
For each data point that you find, visit the source url to confirm numbers.

{task}
""")

print(detailed_report)
```

```python
detailed_report
```

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒç”Ÿæˆäº†è¿™ä¸ªè¾“å‡ºï¼š

```python
|  | Location                                         | Travel Time (hours) |
|--|--------------------------------------------------|---------------------|
| 0  | Bridge of Sighs, Glasgow Necropolis, Glasgow, UK | 8.6                 |
| 1  | Wishart Street, Glasgow, Scotland, UK         | 8.6                 |
```


æ„Ÿè°¢è¿™äº›å¿«é€Ÿæ›´æ”¹ï¼Œæˆ‘ä»¬é€šè¿‡ç®€å•åœ°ä¸ºæˆ‘ä»¬çš„æ™ºèƒ½ä½“æä¾›è¯¦ç»†æç¤ºï¼Œå¹¶èµ‹äºˆå®ƒè§„åˆ’èƒ½åŠ›ï¼Œè·å¾—äº†æ›´åŠ ç®€æ´çš„æŠ¥å‘Šï¼

æ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£æ­£åœ¨å¿«é€Ÿå¡«æ»¡ã€‚æ‰€ä»¥**å¦‚æœæˆ‘ä»¬è¦æ±‚æˆ‘ä»¬çš„æ™ºèƒ½ä½“å°†è¯¦ç»†æœç´¢çš„ç»“æœä¸å¦ä¸€ä¸ªç»“åˆèµ·æ¥ï¼Œå®ƒå°†å˜å¾—æ›´æ…¢ï¼Œå¹¶ä¸”ä¼šè¿…é€Ÿå¢åŠ ä»¤ç‰Œæ•°é‡å’Œæˆæœ¬**ã€‚

â¡ï¸ æˆ‘ä»¬éœ€è¦æ”¹è¿›ç³»ç»Ÿçš„ç»“æ„ã€‚

### âœŒï¸ åœ¨ä¸¤ä¸ªæ™ºèƒ½ä½“ä¹‹é—´åˆ†å‰²ä»»åŠ¡

å¤šæ™ºèƒ½ä½“ç»“æ„å…è®¸åœ¨ä¸åŒå­ä»»åŠ¡ä¹‹é—´åˆ†ç¦»è®°å¿†ï¼Œå¸¦æ¥ä¸¤å¤§å¥½å¤„ï¼š
- æ¯ä¸ªæ™ºèƒ½ä½“æ›´ä¸“æ³¨äºå…¶æ ¸å¿ƒä»»åŠ¡ï¼Œå› æ­¤æ€§èƒ½æ›´ä½³
- åˆ†ç¦»è®°å¿†å‡å°‘äº†æ¯ä¸ªæ­¥éª¤çš„è¾“å…¥ä»¤ç‰Œæ•°é‡ï¼Œä»è€Œå‡å°‘å»¶è¿Ÿå’Œæˆæœ¬ã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå›¢é˜Ÿï¼ŒåŒ…å«ä¸€ä¸ªä¸“é—¨çš„ç½‘ç»œæœç´¢æ™ºèƒ½ä½“ï¼Œç”±å¦ä¸€ä¸ªæ™ºèƒ½ä½“ç®¡ç†ã€‚

ç®¡ç†æ™ºèƒ½ä½“åº”è¯¥å…·æœ‰ç»˜å›¾åŠŸèƒ½æ¥ç¼–å†™å…¶æœ€ç»ˆæŠ¥å‘Šï¼šå› æ­¤è®©æˆ‘ä»¬ç»™å®ƒè®¿é—®é¢å¤–å¯¼å…¥çš„æƒé™ï¼ŒåŒ…æ‹¬ `matplotlib` å’Œ `geopandas` + `shapely` ç”¨äºç©ºé—´ç»˜å›¾ã€‚

```python
model = HfApiModel(
    "Qwen/Qwen2.5-Coder-32B-Instruct", provider="together", max_tokens=8096
)

web_agent = CodeAgent(
    model=model,
    tools=[
        GoogleSearchTool(provider="serper"),
        VisitWebpageTool(),
        calculate_cargo_travel_time,
    ],
    name="web_agent",
    description="Browses the web to find information",
    verbosity_level=0,
    max_steps=10,
)
```

ç®¡ç†æ™ºèƒ½ä½“éœ€è¦è¿›è¡Œä¸€äº›è¾ƒé‡çš„æ€è€ƒå·¥ä½œã€‚

æ‰€ä»¥æˆ‘ä»¬ç»™å®ƒæ›´å¼ºå¤§çš„æ¨¡å‹ [DeepSeek-R1](https://huggingface.co/deepseek-ai/DeepSeek-R1)ï¼Œå¹¶æ·»åŠ  `planning_interval` åˆ°ç»„åˆä¸­ã€‚

```python
from smolagents.utils import encode_image_base64, make_image_url
from smolagents import OpenAIServerModel


def check_reasoning_and_plot(final_answer, agent_memory):
    final_answer
    multimodal_model = OpenAIServerModel("gpt-4o", max_tokens=8096)
    filepath = "saved_map.png"
    assert os.path.exists(filepath), "Make sure to save the plot under saved_map.png!"
    image = Image.open(filepath)
    prompt = (
        f"Here is a user-given task and the agent steps: {agent_memory.get_succinct_steps()}. Now here is the plot that was made."
        "Please check that the reasoning process and plot are correct: do they correctly answer the given task?"
        "First list reasons why yes/no, then write your final decision: PASS in caps lock if it is satisfactory, FAIL if it is not."
        "Don't be harsh: if the plot mostly solves the task, it should pass."
        "To pass, a plot should be made using px.scatter_map and not any other method (scatter_map looks nicer)."
    )
    messages = [
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": prompt,
                },
                {
                    "type": "image_url",
                    "image_url": {"url": make_image_url(encode_image_base64(image))},
                },
            ],
        }
    ]
    output = multimodal_model(messages).content
    print("Feedback: ", output)
    if "FAIL" in output:
        raise Exception(output)
    return True


manager_agent = CodeAgent(
    model=HfApiModel("deepseek-ai/DeepSeek-R1", provider="together", max_tokens=8096),
    tools=[calculate_cargo_travel_time],
    managed_agents=[web_agent],
    additional_authorized_imports=[
        "geopandas",
        "plotly",
        "shapely",
        "json",
        "pandas",
        "numpy",
    ],
    planning_interval=5,
    verbosity_level=2,
    final_answer_checks=[check_reasoning_and_plot],
    max_steps=15,
)
```

è®©æˆ‘ä»¬æ£€æŸ¥è¿™ä¸ªå›¢é˜Ÿæ˜¯ä»€ä¹ˆæ ·å­ï¼š

```python
manager_agent.visualize()
```

è¿™å°†ç”Ÿæˆç±»ä¼¼äºä¸‹é¢çš„å†…å®¹ï¼Œå¸®åŠ©æˆ‘ä»¬ç†è§£æ™ºèƒ½ä½“å’Œä½¿ç”¨çš„å·¥å…·ä¹‹é—´çš„ç»“æ„å’Œå…³ç³»ï¼š

```python
CodeAgent | deepseek-ai/DeepSeek-R1
â”œâ”€â”€ âœ… Authorized imports: ['geopandas', 'plotly', 'shapely', 'json', 'pandas', 'numpy']
â”œâ”€â”€ ğŸ› ï¸ Tools:
â”‚   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”‚   â”ƒ Name                        â”ƒ Description                           â”ƒ Arguments                             â”ƒ
â”‚   â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚   â”‚ calculate_cargo_travel_time â”‚ Calculate the travel time for a cargo â”‚ origin_coords (`array`): Tuple of     â”‚
â”‚   â”‚                             â”‚ plane between two points on Earth     â”‚ (latitude, longitude) for the         â”‚
â”‚   â”‚                             â”‚ using great-circle distance.          â”‚ starting point                        â”‚
â”‚   â”‚                             â”‚                                       â”‚ destination_coords (`array`): Tuple   â”‚
â”‚   â”‚                             â”‚                                       â”‚ of (latitude, longitude) for the      â”‚
â”‚   â”‚                             â”‚                                       â”‚ destination                           â”‚
â”‚   â”‚                             â”‚                                       â”‚ cruising_speed_kmh (`number`):        â”‚
â”‚   â”‚                             â”‚                                       â”‚ Optional cruising speed in km/h       â”‚
â”‚   â”‚                             â”‚                                       â”‚ (defaults to 750 km/h for typical     â”‚
â”‚   â”‚                             â”‚                                       â”‚ cargo planes)                         â”‚
â”‚   â”‚ final_answer                â”‚ Provides a final answer to the given  â”‚ answer (`any`): The final answer to   â”‚
â”‚   â”‚                             â”‚ problem.                              â”‚ the problem                           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€ ğŸ¤– Managed agents:
    â””â”€â”€ web_agent | CodeAgent | Qwen/Qwen2.5-Coder-32B-Instruct
        â”œâ”€â”€ âœ… Authorized imports: []
        â”œâ”€â”€ ğŸ“ Description: Browses the web to find information
        â””â”€â”€ ğŸ› ï¸ Tools:
            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
            â”ƒ Name                        â”ƒ Description                       â”ƒ Arguments                         â”ƒ
            â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
            â”‚ web_search                  â”‚ Performs a google web search for  â”‚ query (`string`): The search      â”‚
            â”‚                             â”‚ your query then returns a string  â”‚ query to perform.                 â”‚
            â”‚                             â”‚ of the top search results.        â”‚ filter_year (`integer`):          â”‚
            â”‚                             â”‚                                   â”‚ Optionally restrict results to a  â”‚
            â”‚                             â”‚                                   â”‚ certain year                      â”‚
            â”‚ visit_webpage               â”‚ Visits a webpage at the given url â”‚ url (`string`): The url of the    â”‚
            â”‚                             â”‚ and reads its content as a        â”‚ webpage to visit.                 â”‚
            â”‚                             â”‚ markdown string. Use this to      â”‚                                   â”‚
            â”‚                             â”‚ browse webpages.                  â”‚                                   â”‚
            â”‚ calculate_cargo_travel_time â”‚ Calculate the travel time for a   â”‚ origin_coords (`array`): Tuple of â”‚
            â”‚                             â”‚ cargo plane between two points on â”‚ (latitude, longitude) for the     â”‚
            â”‚                             â”‚ Earth using great-circle          â”‚ starting point                    â”‚
            â”‚                             â”‚ distance.                         â”‚ destination_coords (`array`):     â”‚
            â”‚                             â”‚                                   â”‚ Tuple of (latitude, longitude)    â”‚
            â”‚                             â”‚                                   â”‚ for the destination               â”‚
            â”‚                             â”‚                                   â”‚ cruising_speed_kmh (`number`):    â”‚
            â”‚                             â”‚                                   â”‚ Optional cruising speed in km/h   â”‚
            â”‚                             â”‚                                   â”‚ (defaults to 750 km/h for typical â”‚
            â”‚                             â”‚                                   â”‚ cargo planes)                     â”‚
            â”‚ final_answer                â”‚ Provides a final answer to the    â”‚ answer (`any`): The final answer  â”‚
            â”‚                             â”‚ given problem.                    â”‚ to the problem                    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
manager_agent.run("""
Find all Batman filming locations in the world, calculate the time to transfer via cargo plane to here (we're in Gotham, 40.7128Â° N, 74.0060Â° W).
Also give me some supercar factories with the same cargo plane transfer time. You need at least 6 points in total.
Represent this as spatial map of the world, with the locations represented as scatter points with a color that depends on the travel time, and save it to saved_map.png!

Here's an example of how to plot and return a map:
import plotly.express as px
df = px.data.carshare()
fig = px.scatter_map(df, lat="centroid_lat", lon="centroid_lon", text="name", color="peak_hour", size=100,
     color_continuous_scale=px.colors.sequential.Magma, size_max=15, zoom=1)
fig.show()
fig.write_image("saved_image.png")
final_answer(fig)

Never try to process strings using code: when you have a string to read, just print it and you'll see it.
""")
```

æˆ‘ä¸çŸ¥é“åœ¨ä½ çš„è¿è¡Œä¸­æƒ…å†µå¦‚ä½•ï¼Œä½†åœ¨æˆ‘çš„è¿è¡Œä¸­ï¼Œç®¡ç†æ™ºèƒ½ä½“å·§å¦™åœ°å°†ä»»åŠ¡åˆ†é…ç»™ç½‘ç»œæ™ºèƒ½ä½“ï¼Œé¦–å…ˆæ˜¯ `1. Search for Batman filming locations`ï¼Œç„¶åæ˜¯ `2. Find supercar factories`ï¼Œæœ€åèšåˆåˆ—è¡¨å¹¶ç»˜åˆ¶åœ°å›¾ã€‚

è®©æˆ‘ä»¬é€šè¿‡ç›´æ¥ä»æ™ºèƒ½ä½“çŠ¶æ€æŸ¥çœ‹åœ°å›¾ï¼š

```python
manager_agent.python_executor.state["fig"]
```

è¿™å°†è¾“å‡ºåœ°å›¾ï¼š

![å¤šæ™ºèƒ½ä½“ç³»ç»Ÿç¤ºä¾‹è¾“å‡ºåœ°å›¾](https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit2/smolagents/output_map.png)

## èµ„æº

- [å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ](https://huggingface.co/docs/smolagents/main/en/examples/multiagents) â€“ å¤šæ™ºèƒ½ä½“ç³»ç»Ÿæ¦‚è¿°ã€‚  
- [ä»€ä¹ˆæ˜¯æ™ºèƒ½ä½“ RAGï¼Ÿ](https://weaviate.io/blog/what-is-agentic-rag) â€“ æ™ºèƒ½ä½“ RAG ä»‹ç»ã€‚  
- [å¤šæ™ºèƒ½ä½“ RAG ç³»ç»Ÿ ğŸ¤–ğŸ¤ğŸ¤– é…æ–¹](https://huggingface.co/learn/cookbook/multiagent_rag_system) â€“ æ„å»ºå¤šæ™ºèƒ½ä½“ RAG ç³»ç»Ÿçš„åˆ†æ­¥æŒ‡å—ã€‚  
