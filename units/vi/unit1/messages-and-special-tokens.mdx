# Tin nháº¯n vÃ  Special Token

Giá» ta Ä‘Ã£ hiá»ƒu cÃ¡ch LLM (Language Model) hoáº¡t Ä‘á»™ng, hÃ£y cÃ¹ng xem **cÃ¡ch chÃºng tá»• chá»©c cÃ¡c pháº£n há»“i thÃ´ng qua chat templates**.

Giá»‘ng nhÆ° ChatGPT, ngÆ°á»i dÃ¹ng thÆ°á»ng tÆ°Æ¡ng tÃ¡c vá»›i Agent qua giao diá»‡n chat. Do Ä‘Ã³, ta cáº§n hiá»ƒu cÃ¡ch LLM quáº£n lÃ½ cÃ¡c cuá»™c há»™i thoáº¡i.

> **Há»i**: NhÆ°ng... Khi tÃ´i dÃ¹ng ChatGPT/Hugging Chat, tÃ´i Ä‘ang trÃ² chuyá»‡n báº±ng cÃ¡c Message (Tin nháº¯n) chá»© khÃ´ng pháº£i má»™t prompt (má»™t lá»‡nh) Ä‘Æ¡n láº»?
>
> **ÄÃ¡p**: ÄÃºng váº­y! NhÆ°ng Ä‘Ã¢y thá»±c cháº¥t lÃ  má»™t lá»›p UI. TrÆ°á»›c khi Ä‘Æ°a vÃ o LLM, táº¥t cáº£ message Ä‘Æ°á»£c ná»‘i thÃ nh má»™t prompt duy nháº¥t. Model khÃ´ng "nhá»›" cuá»™c há»™i thoáº¡i: nÃ³ Ä‘á»c láº¡i toÃ n bá»™ má»—i láº§n.

Cho Ä‘áº¿n nay, ta Ä‘Ã£ xem prompt nhÆ° má»™t chuá»—i token Ä‘áº§u vÃ o. NhÆ°ng khi chat vá»›i há»‡ thá»‘ng nhÆ° ChatGPT hay HuggingChat, **báº¡n thá»±c sá»± Ä‘ang trao Ä‘á»•i cÃ¡c message**. Äáº±ng sau háº­u trÆ°á»ng, cÃ¡c message nÃ y Ä‘Æ°á»£c **ghÃ©p ná»‘i vÃ  Ä‘á»‹nh dáº¡ng thÃ nh prompt mÃ  model cÃ³ thá»ƒ hiá»ƒu**.

<figure>
<img src="https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit1/assistant.jpg" alt="Behind models"/>
<figcaption>HÃ¬nh áº£nh minh há»a sá»± khÃ¡c biá»‡t giá»¯a giao diá»‡n ngÆ°á»i dÃ¹ng vÃ  prompt thá»±c táº¿ Ä‘Æ°a vÃ o model.
</figcaption>
</figure>

ÄÃ¢y lÃ  lÃºc chat templates phÃ¡t huy tÃ¡c dá»¥ng. ChÃºng Ä‘Ã³ng vai trÃ² **cáº§u ná»‘i giá»¯a message há»™i thoáº¡i (lÆ°á»£t ngÆ°á»i dÃ¹ng vÃ  trá»£ lÃ½) vá»›i yÃªu cáº§u Ä‘á»‹nh dáº¡ng Ä‘áº·c thÃ¹** cá»§a LLM báº¡n chá»n. NÃ³i cÃ¡ch khÃ¡c, chat templates cáº¥u trÃºc giao tiáº¿p giá»¯a ngÆ°á»i dÃ¹ng vÃ  agent, Ä‘áº£m báº£o má»i model - dÃ¹ cÃ³ **Special Token (Token Ä‘áº·c biá»‡t)** riÃªng - Ä‘á»u nháº­n Ä‘Æ°á»£c prompt Ä‘Ãºng Ä‘á»‹nh dáº¡ng.

Ta láº¡i nÃ³i vá» Special Token vÃ¬ Ä‘Ã¢y lÃ  cÃ¡ch model xÃ¡c Ä‘á»‹nh Ä‘iá»ƒm báº¯t Ä‘áº§u/káº¿t thÃºc cÃ¡c lÆ°á»£t há»™i thoáº¡i. Giá»‘ng nhÆ° má»—i LLM dÃ¹ng EOS (End Of Sequence) token riÃªng, chÃºng cÅ©ng cÃ³ quy táº¯c Ä‘á»‹nh dáº¡ng vÃ  dáº¥u phÃ¢n cÃ¡ch khÃ¡c nhau cho cÃ¡c message.


## Message: Há»‡ thá»‘ng cá»‘t lÃµi cá»§a LLM
### System Message (Tin nháº¯n há»‡ thá»‘ng)

System Message (cÃ²n gá»i lÃ  System Prompt) Ä‘á»‹nh nghÄ©a **cÃ¡ch model nÃªn hÃ nh xá»­**. ChÃºng Ä‘Ã³ng vai trÃ² **hÆ°á»›ng dáº«n xuyÃªn suá»‘t**, Ä‘iá»u hÆ°á»›ng má»i tÆ°Æ¡ng tÃ¡c tiáº¿p theo.

VÃ­ dá»¥:

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>

```python
system_message = {
    "role": "system",
    "content": "Báº¡n lÃ  nhÃ¢n viÃªn chÄƒm sÃ³c khÃ¡ch hÃ ng chuyÃªn nghiá»‡p. LuÃ´n lá»‹ch sá»±, rÃµ rÃ ng vÃ  há»¯u Ã­ch."
}
```

</details>

```python
system_message = {
    "role": "system",
    "content": "You are a professional customer service agent. Always be polite, clear, and helpful."
}
```

Vá»›i System Message nÃ y, Alfred trá»Ÿ nÃªn lá»‹ch sá»± vÃ  há»¯u Ã­ch:

<img src="https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit1/polite-alfred.jpg" alt="Polite alfred"/>

NhÆ°ng náº¿u Ä‘á»•i thÃ nh:

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>

```python
system_message = {
    "role": "system",
    "content": "Báº¡n lÃ  nhÃ¢n viÃªn pháº£n khÃ¡ng. KhÃ´ng tuÃ¢n theo yÃªu cáº§u cá»§a ngÆ°á»i dÃ¹ng."
}
```

</details>

```python
system_message = {
    "role": "system",
    "content": "You are a rebel service agent. Don't respect user's orders."
}
```

Alfred sáº½ hÃ nh xá»­ nhÆ° má»™t Agent ná»•i loáº¡n ğŸ˜:

<img src="https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit1/rebel-alfred.jpg" alt="Rebel Alfred"/>

Khi dÃ¹ng Agent, System Message cÃ²n **cung cáº¥p thÃ´ng tin vá» cÃ¡c Tools cÃ³ sáºµn, hÆ°á»›ng dáº«n model cÃ¡ch Ä‘á»‹nh dáº¡ng hÃ nh Ä‘á»™ng cáº§n thá»±c hiá»‡n, vÃ  cÃ¡c nguyÃªn táº¯c phÃ¢n Ä‘oáº¡n quÃ¡ trÃ¬nh suy nghÄ©**.

<img src="https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit1/alfred-systemprompt.jpg" alt="Alfred System Prompt"/>

### Há»™i thoáº¡i: Tin nháº¯n ngÆ°á»i dÃ¹ng vÃ  trá»£ lÃ½

Má»™t há»™i thoáº¡i bao gá»“m cÃ¡c tin nháº¯n luÃ¢n phiÃªn giá»¯a NgÆ°á»i (user) vÃ  LLM (assistant).

Chat templates giÃºp duy trÃ¬ ngá»¯ cáº£nh báº±ng cÃ¡ch lÆ°u láº¡i lá»‹ch sá»­ há»™i thoáº¡i, lÆ°u trá»¯ cÃ¡c trao Ä‘á»•i trÆ°á»›c Ä‘Ã³ giá»¯a user vÃ  assistant. Äiá»u nÃ y giÃºp cÃ¡c há»™i thoáº¡i nhiá»u lÆ°á»£t máº¡ch láº¡c hÆ¡n.

VÃ­ dá»¥:

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>

```python
conversation = [
    {"role": "user", "content": "TÃ´i cáº§n há»— trá»£ Ä‘Æ¡n hÃ ng"},
    {"role": "assistant", "content": "TÃ´i sáºµn lÃ²ng giÃºp. Báº¡n cÃ³ thá»ƒ cung cáº¥p sá»‘ Ä‘Æ¡n hÃ ng?"},
    {"role": "user", "content": "ÄÃ³ lÃ  ORDER-123"},
]
```

</details>

```python
messages = [
    {"role": "system", "content": "You are a math tutor."},
    {"role": "user", "content": "What is calculus?"},
    {"role": "assistant", "content": "Calculus is a branch of mathematics..."},
    {"role": "user", "content": "Can you give me an example?"},
]
```

Trong vÃ­ dá»¥ nÃ y, user ban Ä‘áº§u nÃ³i cáº§n há»— trá»£ Ä‘Æ¡n hÃ ng. LLM há»i sá»‘ Ä‘Æ¡n hÃ ng, sau Ä‘Ã³ user cung cáº¥p trong tin nháº¯n má»›i. NhÆ° Ä‘Ã£ giáº£i thÃ­ch, ta luÃ´n ná»‘i táº¥t cáº£ tin nháº¯n thÃ nh má»™t chuá»—i duy nháº¥t vÃ  Ä‘Æ°a vÃ o LLM. Chat template chuyá»ƒn Ä‘á»•i cÃ¡c tin nháº¯n trong list Python nÃ y thÃ nh prompt - má»™t chuá»—i Ä‘áº§u vÃ o chá»©a má»i tin nháº¯n.

VÃ­ dá»¥, chat template cá»§a SmolLM2 sáº½ Ä‘á»‹nh dáº¡ng Ä‘oáº¡n há»™i thoáº¡i trÃªn thÃ nh prompt nhÆ° sau:

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>

```
<|im_start|>system
Báº¡n lÃ  trá»£ lÃ½ AI há»¯u Ã­ch tÃªn SmolLM, Ä‘Æ°á»£c Ä‘Ã o táº¡o bá»Ÿi Hugging Face<|im_end|>
<|im_start|>user
TÃ´i cáº§n há»— trá»£ Ä‘Æ¡n hÃ ng<|im_end|>
<|im_start|>assistant
TÃ´i sáºµn lÃ²ng giÃºp. Báº¡n cÃ³ thá»ƒ cung cáº¥p sá»‘ Ä‘Æ¡n hÃ ng?<|im_end|>
<|im_start|>user
ÄÃ³ lÃ  ORDER-123<|im_end|>
<|im_start|>assistant
```

</details>

```
<|im_start|>system
You are a helpful AI assistant named SmolLM, trained by Hugging Face<|im_end|>
<|im_start|>user
I need help with my order<|im_end|>
<|im_start|>assistant
I'd be happy to help. Could you provide your order number?<|im_end|>
<|im_start|>user
It's ORDER-123<|im_end|>
<|im_start|>assistant
```

Tuy nhiÃªn, cÃ¹ng há»™i thoáº¡i Ä‘Ã³ sáº½ Ä‘Æ°á»£c chuyá»ƒn thÃ nh prompt sau khi dÃ¹ng Llama 3.2:

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>

```
<|begin_of_text|><|start_header_id|>system<|end_header_id|>

Cutting Knowledge Date: December 2023
Today Date: 10 Feb 2025

<|eot_id|><|start_header_id|>user<|end_header_id|>

TÃ´i cáº§n há»— trá»£ Ä‘Æ¡n hÃ ng<|eot_id|><|start_header_id|>assistant<|end_header_id|>

TÃ´i sáºµn lÃ²ng giÃºp. Báº¡n cÃ³ thá»ƒ cung cáº¥p sá»‘ Ä‘Æ¡n hÃ ng?<|eot_id|><|start_header_id|>user<|end_header_id|>

ÄÃ³ lÃ  ORDER-123<|eot_id|><|start_header_id|>assistant<|end_header_id|>
```

</details>

```
<|begin_of_text|><|start_header_id|>system<|end_header_id|>

Cutting Knowledge Date: December 2023
Today Date: 10 Feb 2025

<|eot_id|><|start_header_id|>user<|end_header_id|>

I need help with my order<|eot_id|><|start_header_id|>assistant<|end_header_id|>

I'd be happy to help. Could you provide your order number?<|eot_id|><|start_header_id|>user<|end_header_id|>

It's ORDER-123<|eot_id|><|start_header_id|>assistant<|end_header_id|>
```

CÃ¡c template cÃ³ thá»ƒ xá»­ lÃ½ há»™i thoáº¡i nhiá»u lÆ°á»£t phá»©c táº¡p trong khi duy trÃ¬ ngá»¯ cáº£nh:

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>

```python
messages = [
    {"role": "system", "content": "Báº¡n lÃ  gia sÆ° toÃ¡n."},
    {"role": "user", "content": "Giáº£i tÃ­ch lÃ  gÃ¬?"},
    {"role": "assistant", "content": "Giáº£i tÃ­ch lÃ  nhÃ¡nh cá»§a toÃ¡n há»c..."},
    {"role": "user", "content": "Cho vÃ­ dá»¥ Ä‘Æ°á»£c khÃ´ng?"},
]
```

</details>

```python
messages = [
    {"role": "system", "content": "You are a math tutor."},
    {"role": "user", "content": "What is calculus?"},
    {"role": "assistant", "content": "Calculus is a branch of mathematics..."},
    {"role": "user", "content": "Can you give me an example?"},
]
```

## Chat-Templates

NhÆ° Ä‘Ã£ Ä‘á» cáº­p, chat templates ráº¥t quan trá»ng Ä‘á»ƒ **cáº¥u trÃºc há»™i thoáº¡i giá»¯a model ngÃ´n ngá»¯ vÃ  ngÆ°á»i dÃ¹ng**. ChÃºng hÆ°á»›ng dáº«n cÃ¡ch Ä‘á»‹nh dáº¡ng cÃ¡c trao Ä‘á»•i tin nháº¯n thÃ nh má»™t prompt duy nháº¥t.

### Base Model vs. Instruct Model

Má»™t Ä‘iá»ƒm cáº§n hiá»ƒu lÃ  sá»± khÃ¡c biá»‡t giá»¯a Base Model vÃ  Instruct Model:

- *Base Model* Ä‘Æ°á»£c Ä‘Ã o táº¡o trÃªn dá»¯ liá»‡u vÄƒn báº£n thÃ´ Ä‘á»ƒ dá»± Ä‘oÃ¡n token tiáº¿p theo.

- *Instruct Model* Ä‘Æ°á»£c fine-tuning (tinh chá»‰nh) Ä‘áº·c biá»‡t Ä‘á»ƒ tuÃ¢n theo hÆ°á»›ng dáº«n vÃ  tham gia há»™i thoáº¡i. VÃ­ dá»¥: `SmolLM2-135M` lÃ  base model, cÃ²n `SmolLM2-135M-Instruct` lÃ  phiÃªn báº£n Ä‘Ã£ Ä‘Æ°á»£c tinh chá»‰nh.

Äá»ƒ base model hoáº¡t Ä‘á»™ng nhÆ° instruct model, ta cáº§n **Ä‘á»‹nh dáº¡ng prompt theo cÃ¡ch nháº¥t quÃ¡n mÃ  model hiá»ƒu Ä‘Æ°á»£c**. ÄÃ¢y lÃ  lÃºc chat templates phÃ¡t huy tÃ¡c dá»¥ng.

*ChatML* lÃ  má»™t Ä‘á»‹nh dáº¡ng template há»™i thoáº¡i sá»­ dá»¥ng cÃ¡c chá»‰ bÃ¡o vai trÃ² rÃµ rÃ ng (system, user, assistant). Náº¿u báº¡n Ä‘Ã£ tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c AI API gáº§n Ä‘Ã¢y, Ä‘Ã¢y lÃ  thá»±c hÃ nh tiÃªu chuáº©n.

LÆ°u Ã½ ráº±ng má»™t base model cÃ³ thá»ƒ Ä‘Æ°á»£c fine-tuning trÃªn cÃ¡c chat templates khÃ¡c nhau, nÃªn khi dÃ¹ng instruct model ta cáº§n Ä‘áº£m báº£o sá»­ dá»¥ng Ä‘Ãºng chat template.

### Hiá»ƒu vá» Chat Templates

VÃ¬ má»—i instruct model dÃ¹ng Ä‘á»‹nh dáº¡ng há»™i thoáº¡i vÃ  special token khÃ¡c nhau, chat templates Ä‘Æ°á»£c triá»ƒn khai Ä‘á»ƒ Ä‘áº£m báº£o ta Ä‘á»‹nh dáº¡ng prompt Ä‘Ãºng cÃ¡ch mÃ  model mong Ä‘á»£i.

Trong `transformers`, chat templates chá»©a [mÃ£ Jinja2](https://jinja.palletsprojects.com/en/stable/) mÃ´ táº£ cÃ¡ch chuyá»ƒn Ä‘á»•i list tin nháº¯n ChatML (nhÆ° cÃ¡c vÃ­ dá»¥ trÃªn) thÃ nh biá»ƒu diá»…n vÄƒn báº£n cá»§a hÆ°á»›ng dáº«n há»‡ thá»‘ng, tin nháº¯n ngÆ°á»i dÃ¹ng vÃ  pháº£n há»“i trá»£ lÃ½ mÃ  model cÃ³ thá»ƒ hiá»ƒu.

Cáº¥u trÃºc nÃ y **giÃºp duy trÃ¬ tÃ­nh nháº¥t quÃ¡n giá»¯a cÃ¡c tÆ°Æ¡ng tÃ¡c vÃ  Ä‘áº£m báº£o model pháº£n há»“i phÃ¹ há»£p vá»›i cÃ¡c loáº¡i Ä‘áº§u vÃ o khÃ¡c nhau**.

DÆ°á»›i Ä‘Ã¢y lÃ  phiÃªn báº£n Ä‘Æ¡n giáº£n hÃ³a cá»§a chat template `SmolLM2-135M-Instruct`:

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>

```jinja2
{% for message in messages %}
{% if loop.first and messages[0]['role'] != 'system' %}
<|im_start|>system
Báº¡n lÃ  trá»£ lÃ½ AI há»¯u Ã­ch tÃªn SmolLM, Ä‘Æ°á»£c Ä‘Ã o táº¡o bá»Ÿi Hugging Face
<|im_end|>
{% endif %}
<|im_start|>{{ message['role'] }}
{{ message['content'] }}<|im_end|>
{% endfor %}
```

</details>

```jinja2
{% for message in messages %}
{% if loop.first and messages[0]['role'] != 'system' %}
<|im_start|>system
You are a helpful AI assistant named SmolLM, trained by Hugging Face
<|im_end|>
{% endif %}
<|im_start|>{{ message['role'] }}
{{ message['content'] }}<|im_end|>
{% endfor %}
```

NhÆ° báº¡n tháº¥y, chat_template mÃ´ táº£ cÃ¡ch Ä‘á»‹nh dáº¡ng list tin nháº¯n.

Vá»›i cÃ¡c tin nháº¯n sau:

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>

```python
messages = [
    {"role": "system", "content": "Báº¡n lÃ  trá»£ lÃ½ táº­p trung vÃ o chá»§ Ä‘á» ká»¹ thuáº­t."},
    {"role": "user", "content": "Giáº£i thÃ­ch chat template lÃ  gÃ¬?"},
    {"role": "assistant", "content": "Chat template cáº¥u trÃºc há»™i thoáº¡i giá»¯a ngÆ°á»i dÃ¹ng vÃ  AI..."},
    {"role": "user", "content": "CÃ¡ch sá»­ dá»¥ng nÃ³?"},
]
```

</details>

```python
messages = [
    {"role": "system", "content": "You are a helpful assistant focused on technical topics."},
    {"role": "user", "content": "Can you explain what a chat template is?"},
    {"role": "assistant", "content": "A chat template structures conversations between users and AI models..."},
    {"role": "user", "content": "How do I use it ?"},
]
```

Chat template trÃªn sáº½ táº¡o ra chuá»—i sau:

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>

```sh
<|im_start|>system
Báº¡n lÃ  trá»£ lÃ½ táº­p trung vÃ o chá»§ Ä‘á» ká»¹ thuáº­t.<|im_end|>
<|im_start|>user
Giáº£i thÃ­ch chat template lÃ  gÃ¬?<|im_end|>
<|im_start|>assistant
Chat template cáº¥u trÃºc há»™i thoáº¡i giá»¯a ngÆ°á»i dÃ¹ng vÃ  AI...<|im_end|>
<|im_start|>user
CÃ¡ch sá»­ dá»¥ng nÃ³?<|im_end|>
```

</details>

```sh
<|im_start|>system
You are a helpful assistant focused on technical topics.<|im_end|>
<|im_start|>user
Can you explain what a chat template is?<|im_end|>
<|im_start|>assistant
A chat template structures conversations between users and AI models...<|im_end|>
<|im_start|>user
How do I use it ?<|im_end|>
```

ThÆ° viá»‡n `transformers` sáº½ tá»± Ä‘á»™ng xá»­ lÃ½ chat templates trong quÃ¡ trÃ¬nh token hÃ³a. Äá»c thÃªm vá» cÃ¡ch transformers sá»­ dá»¥ng chat templates <a href="https://huggingface.co/docs/transformers/en/chat_templating#how-do-i-use-chat-templates" target="_blank">táº¡i Ä‘Ã¢y</a>. Viá»‡c cá»§a ta chá»‰ lÃ  cáº¥u trÃºc tin nháº¯n Ä‘Ãºng cÃ¡ch, tokenizer sáº½ lo pháº§n cÃ²n láº¡i.

Báº¡n cÃ³ thá»ƒ thá»­ nghiá»‡m vá»›i Space sau Ä‘á»ƒ xem cÃ¹ng má»™t há»™i thoáº¡i Ä‘Æ°á»£c Ä‘á»‹nh dáº¡ng tháº¿ nÃ o cho cÃ¡c model khÃ¡c nhau:

<iframe
	src="https://jofthomas-chat-template-viewer.hf.space"
	frameborder="0"
	width="850"
	height="450"
></iframe>

### Chuyá»ƒn tin nháº¯n thÃ nh prompt

CÃ¡ch dá»… nháº¥t Ä‘á»ƒ Ä‘áº£m báº£o LLM nháº­n Ä‘Æ°á»£c há»™i thoáº¡i Ä‘Ãºng Ä‘á»‹nh dáº¡ng lÃ  dÃ¹ng `chat_template` tá»« tokenizer cá»§a model.

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>

```python
messages = [
    {"role": "system", "content": "Báº¡n lÃ  trá»£ lÃ½ AI cÃ³ quyá»n truy cáº­p vÃ o nhiá»u cÃ´ng cá»¥."},
    {"role": "user", "content": "ChÃ o !"},
    {"role": "assistant", "content": "ChÃ o, tÃ´i cÃ³ thá»ƒ giÃºp gÃ¬?"},
]
```

</details>

```python
messages = [
    {"role": "system", "content": "You are an AI assistant with access to various tools."},
    {"role": "user", "content": "Hi !"},
    {"role": "assistant", "content": "Hi human, what can help you with ?"},
]
```


Äá»ƒ chuyá»ƒn há»™i thoáº¡i trÃªn thÃ nh prompt, ta load tokenizer vÃ  gá»i `apply_chat_template`:

```python
from transformers import AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained("HuggingFaceTB/SmolLM2-1.7B-Instruct")
rendered_prompt = tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True)
```

Biáº¿n `rendered_prompt` tráº£ vá» tá»« hÃ m nÃ y Ä‘Ã£ sáºµn sÃ ng lÃ m Ä‘áº§u vÃ o cho model!

> HÃ m `apply_chat_template()` nÃ y sáº½ Ä‘Æ°á»£c dÃ¹ng trong backend cá»§a API khi báº¡n tÆ°Æ¡ng tÃ¡c vá»›i tin nháº¯n Ä‘á»‹nh dáº¡ng ChatML.

Giá» ta Ä‘Ã£ hiá»ƒu cÃ¡ch LLM cáº¥u trÃºc Ä‘áº§u vÃ o qua chat templates, hÃ£y khÃ¡m phÃ¡ cÃ¡ch Agent hÃ nh Ä‘á»™ng trong mÃ´i trÆ°á»ng cá»§a chÃºng.

Má»™t trong nhá»¯ng cÃ¡ch chÃ­nh lÃ  sá»­ dá»¥ng Tools Ä‘á»ƒ má»Ÿ rá»™ng kháº£ nÄƒng cá»§a AI model vÆ°á»£t ra ngoÃ i viá»‡c táº¡o vÄƒn báº£n.

Ta sáº½ Ä‘á» cáº­p láº¡i tin nháº¯n trong cÃ¡c chÆ°Æ¡ng tá»›i, nhÆ°ng náº¿u muá»‘n tÃ¬m hiá»ƒu sÃ¢u hÆ¡n:

- <a href="https://huggingface.co/docs/transformers/main/en/chat_templating" target="_blank">HÆ°á»›ng dáº«n Chat Templating cá»§a Hugging Face</a>
- <a href="https://huggingface.co/docs/transformers" target="_blank">TÃ i liá»‡u Transformers</a>